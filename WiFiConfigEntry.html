  <!DOCTYPE HTML>  
  <html>
  <META name='viewport' content='width=device-width, initial-scale=1'>
        <title>network</title>
  <SCRIPT>
  xmlHttp=createXmlHttpObject();

  function createXmlHttpObject(){
    if(window.XMLHttpRequest){
      xmlHttp=new XMLHttpRequest();
    }else{
      xmlHttp=new ActiveXObject('Microsoft.XMLHTTP');
    }
    return xmlHttp;
  }

  function selectSSID(SSID) {
	    var ssid=document.getElementById("Selected");
	    ssid.value=SSID;
	}
  
  function connectSSID(){
	  if(xmlHttp.readyState==0||xmlHttp.readyState==4){
	      xmlHttp.open('PUT','ConnectToWifi?SSCID=\"'+document.getElementById("Selected").value
	    		  +'\"&PWD=\"'+ document.getElementById("PWD").value
	    		  +'\"',true);
	      xmlHttp.send(null);
	    }
  }
  
  function refreshSSIDs(){
	  var myNode = document.getElementById("list");	  
	  var li = document.createElement("LI");	      
	  var node = document.createTextNode("scanning...");
	  li.appendChild(node);
 
	  myNode.appendChild(li);
	if(xmlHttp.readyState==0||xmlHttp.readyState==4){
	    xmlHttp.onreadystatechange=function(){
	      if(xmlHttp.readyState==4&&xmlHttp.status==200){  
   	  
	    	  while (myNode.firstChild) {
	    	      myNode.removeChild(myNode.firstChild);
	    	  }	   

	    	  wifiList= this.responseXML.getElementsByTagName("wifi");
	    	  li = document.createElement("LI");	      
	    	  node = document.createTextNode("len");
	    	  li.appendChild(node);
	    	  
	    	  for (var i=0;i<wifiList.length; i++) {	
	    		  var line=wifiList[i];
			      var SSID = line.getAttributeNode("SSID").value;
			      var RSSI = parseInt(line.getAttributeNode("RSSI").value);
			      var RSSIverb="---";
			      if(-30<=RSSI){
			    	  RSSIverb="Amazing";
			      }else if(-67<=RSSI){
			    	  RSSIverb="Very Good";
			      }else if(-70<=RSSI){
			    	  RSSIverb="Okay";
			      }else if(-80<=RSSI){
			    	  RSSIverb="Not Good";			      
		    	  }else if(-90<=RSSI){
			    	  RSSIverb="Unusable";
			      }
			      
			      var encryptted="";
			      if(parseInt(line.getAttributeNode("encryptionType").value)!=7){
			    	  encryptted="#";
			      }
				  
			      var li = document.createElement("LI");
				  var att = document.createAttribute("onclick");
				  var cmd="selectSSID('"+SSID+"');";
			      att.value = cmd;
				  li.setAttributeNode(att);     
				  var node = document.createTextNode(SSID+"  "+RSSI+'dBm('+RSSIverb+')'+encryptted);
				  li.appendChild(node);
			 
				  myNode.appendChild(li);
	    	  }
	      }
	    }
	    xmlHttp.open('GET','ScanWifi',true);
	    xmlHttp.send(null);
	  }	  
	}
  
  function myFunctionClear(){	  
	  var myNode = document.getElementById("list");
	  while (myNode.firstChild) {
	      myNode.removeChild(myNode.firstChild);
	  }	    

	}

  </SCRIPT>

 <BODY onload='refreshSSIDs()'>  
  
	Wifi networks list <button onclick="refreshSSIDs()">refresh</button>
<div id="container">
  <ul id="list"></ul>
</div>
	<button onclick="myFunctionClear()">clear </button><BR/>
	Selected=<input id="Selected" type="text" name="Selected" value="sdf"><BR/>
	PWD=<input id="PWD" type="password" name="PDW" value=""><BR/>
	<button onclick="connectSSID()">Connect </button><BR/>
  </BODY>
  </HTML>